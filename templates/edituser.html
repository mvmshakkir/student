<!-- <!DOCTYPE html>
<html>
<head>
    <title>Student Registration</title>
</head>
<body>
    <h1>Student Registration Form</h1>
    
        <label >Name:</label><br>
        <input type="text" id="name" name="name"><br><br>
        <label >Department:</label><br>
        <input type="text" id="department" name="department"><br><br>
        <label >Father Name:</label><br>
        <input type="text" id="father_name" name="father_name"><br><br>
        <label >Place:</label><br>
        <input type="text" id="place" name="place"><br><br>
        <label >Mobile:</label><br>
        <input type="text" id="mobile" name="mobile"><br><br>
        <label >Email:</label><br>
        <input type="text" id="email" name="email"><br><br>
        <label >Password:</label><br>
        <input type="text" id="password" name="password"><br><br>
        
        <label >Confirm Password:</label><br>
        <input type="text" id="conform_password" name="conform_password"><br><br>
        
        <button onclick="registerStudent()">Register</button>
    </body>
    </html> -->
    
    <!-- <html>
        <head>
            <link rel="stylesheet" href="/static/register.css">
        </head>
    
   <body>
    <div class="background-container" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;">
    <img src="/static/school.jpg" style="width: 100%; height: 100%; object-fit: cover; opacity: 0.5;" />
</div>
<div class="form_wrapper">
  <div class="form_container">
    <div class="title_container">
      <h2>Register</h2>
    </div>
    <div class="row clearfix">
        {% for u in users %}
      <div class="">
       
          <div class="input_field"> <span><i aria-hidden="true" class="fa fa-envelope"></i></span>
            <label for="">Name</label>
            <input type="text" name="name" id="name" value="{{ u.name }}"  required>
          </div>
          <div class="input_field"> <span><i aria-hidden="true" class="fa fa-lock"></i></span>
            <label>Department</label>
            <input type="text" id="department" name="department" value="{{ u.department }}" required />
          </div>
          <div class="input_field"> <span><i aria-hidden="true" class="fa fa-lock"></i></span>
            <label>Father name</label>
            <input type="text" id="father_name" name="father_name" value="{{ u.father_name }}" required />
          </div>
          <div class="input_field"> <span><i aria-hidden="true" class="fa fa-lock"></i></span>
            <label>Place</label>
            <input type="text" id="place" name="place" value="{{ u.place }}"  required />
          </div>
          <div class="input_field"> <span><i aria-hidden="true" class="fa fa-lock"></i></span>
            <label>Mobile</label>
            <input type="text" id="mobile" name="mobile" value="{{ u.mobile }}" required />
         </div> 
          <div>
            <input class="button-success" type="submit" onclick="registerStudent()" value="Register" style="background-color: rgb(54, 218, 125);height: 35px;"/>
          </div>
          
            	
    
       
      
      
    </div>
    {% endfor %}
  </div>
</div>

</body>
</html> -->
<html>
    <head>
        <link rel="stylesheet" href="/static/register.css">
    </head>
    <body>
        <div class="background-container" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;">
            <img src="/static/school.jpg" style="width: 100%; height: 100%; object-fit: cover; opacity: 0.5;" />
        </div>
        <div class="form_wrapper">
            <div class="form_container">
                <div class="title_container">
                    <h2>Register</h2>
                </div>
                
                <div class="row clearfix">
                   
                    <div class="">
                        <div class="input_field"> <span><i aria-hidden="true" class="fa fa-envelope"></i></span>
                            <label for="">Name</label>
                            <input type="text" name="name" id="name" value="{{ user.name }}"  required>
                          </div>
                          <div class="input_field"> <span><i aria-hidden="true" class="fa fa-lock"></i></span>
                            <label>Department</label>
                            <input type="text" id="department" name="department" value="{{ user.department }}" required />
                          </div>
                          <div class="input_field"> <span><i aria-hidden="true" class="fa fa-lock"></i></span>
                            <label>Father name</label>
                            <input type="text" id="father_name" name="father_name" value="{{ user.father_name }}" required />
                          </div>
                          <div class="input_field"> <span><i aria-hidden="true" class="fa fa-lock"></i></span>
                            <label>Place</label>
                            <input type="text" id="place" name="place" value="{{ user.place }}"  required />
                          </div>
                          <div class="input_field"> <span><i aria-hidden="true" class="fa fa-lock"></i></span>
                            <label>Mobile</label>
                            <input type="text" id="mobile" name="mobile" value="{{ user.mobile }}" required />
                         </div> 
                         <div class="input_field"> <span><i aria-hidden="true" class="fa fa-lock"></i></span>
                          <label>Email</label>
                          <input type="text" id="email" name="email" value="{{ user.email }}" required />
                    </div>
                   
                    <div>
                        <input class="button-success" type="submit" onclick="registerStudentt()" value="Register" style="background-color: rgb(54, 218, 125);height: 35px;"/>
                      </div>
                </div>
            </div>
        </div>
    </body>
</html>

<script>
let student_id; // Declaring student_id in the broader scope
console.log(student_id)
document.addEventListener("DOMContentLoaded", function() {
    // Assuming access_token and token_type are stored in localStorage after successful login
    const access_token = localStorage.getItem('access_token');
    const token_type = localStorage.getItem('token_type');
    student_id = localStorage.getItem('student_id'); // Assigning value to student_id
    console.log(access_token);
    console.log(student_id);
    myFunctionUsingStudentID(student_id);
});
function myFunctionUsingStudentID(student_id) {
    // Use student_id here or call another function that depends on it
    console.log(student_id); // This should log the correct student_id value
}
async function registerStudentt() {
    const name = document.getElementById('name').value;
    const department = document.getElementById('department').value;
    const father_name = document.getElementById('father_name').value;
    const place = document.getElementById('place').value;
    const mobile = document.getElementById('mobile').value;
    const email = document.getElementById('email').value;

    if (name === '' || department === '' || father_name === '' || place === '' || mobile === ''|| email==='') {
        alert('Please fill in all fields');
        return;
    }

    const data = {
        name,
        department,
        father_name,
        place,
        mobile,
        email
    };

    console.log(data);

    try {
      
      console.log(`Fetching with student ID: ${student_id}`);
        const response = await fetch(`/update/${student_id}`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
        });

        if (!response.ok) {
            throw new Error('Network response was not ok');
        }

        const responseData = await response.json();
        console.log(responseData);
        window.location.href = '/home';

        // Handle the response accordingly (redirect, display a message, etc.)
    } catch (error) {
        console.error('There was an error!', error);
        // Handle errors here
    }
}

</script>

